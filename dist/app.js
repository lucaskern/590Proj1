"use strict";!function t(e,i,s){function a(l,o){if(!i[l]){if(!e[l]){var h="function"==typeof require&&require;if(!o&&h)return h(l,!0);if(r)return r(l,!0);var n=new Error("Cannot find module '"+l+"'");throw n.code="MODULE_NOT_FOUND",n}var c=i[l]={exports:{}};e[l][0].call(c.exports,function(t){var i=e[l][1][t];return a(i||t)},c,c.exports,t,e,i,s)}return i[l].exports}for(var r="function"==typeof require&&require,l=0;l<s.length;l++)a(s[l]);return a}({1:[function(t,e,i){$(function(){$("#tabs").tabs(),$("#controls-toggle").click(function(){$("#tabs").slideToggle("slow",function(){})}),$("#info-box").hide(),$("#info-toggle").click(function(){$("#info-box").slideToggle("slow",function(){})})})},{}],2:[function(t,e,i){var s=t("./main.js");t("./controls");window.addEventListener("load",function(){console.log("window.onload ran");s.init()})},{"./controls":1,"./main.js":3}],3:[function(t,e,i){var s={canvas:void 0,ctx:void 0,firstRun:!0,accurate:!1,playBool:!0,audioClick:!0,glitch:!1,frames:100,framesLimit:3,grid:[],temp:[],width:20,height:20,cellSize:25,maxAge:30,bgOpacity:.3,colorRate:6,colorMode:"pulseF",colorVal:null,hueVal:100,satVal:8,brightVal:8,slowCount:0,border:!0,lineW:1,instrument:"gong",sound:!1,shape:"flyer",camera:void 0,scene:void 0,renderer:void 0,geometry:void 0,texture:void 0,mesh:void 0,threeWidth:window.innerWidth,threeHeight:window.innerHeight/2,liveCount:0,audCtx:void 0,osc:void 0,init:function(){console.log("app.main.init() called"),this.canvas=document.querySelector("canvas"),this.ctx=this.canvas.getContext("2d"),this.renderer=new THREE.WebGLRenderer,this.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this.renderer.domElement),this.renderer.domElement.id="threeCan",this.scene=new THREE.Scene,this.camera=new THREE.PerspectiveCamera(70,this.threeWidth/this.threeHeight,1,1e3),this.camera.position.z=500,this.scene.add(this.camera),this.texture=new THREE.Texture(this.canvas);var t=new THREE.MeshBasicMaterial({map:this.texture});console.log(this.texture),this.geometry=new THREE.BoxGeometry(300,300,300),this.mesh=new THREE.Mesh(this.geometry,t),this.scene.add(this.mesh),this.canvas.width=this.canvas.height=this.size,this.controls(),console.log("init ran"),this.audCtx=new AudioContext,this.osc=this.audCtx.createOscillator(),this.osc.type="sawtooth",this.osc.start(),this.firstRun&&(this.gridSetup(),this.firstRun=!1),this.animate(),this.update()},animate:function(){this.animationID=requestAnimationFrame(this.animate.bind(this)),this.update(),this.texture.needsUpdate=!0,this.mesh.rotation.y+=.01,this.mesh.rotation.x+=.02,this.renderer.render(this.scene,this.camera)},gridSetup:function(){this.grid=[],this.temp=[],this.canvas.width=(this.width-2)*this.cellSize,this.canvas.height=(this.height-2)*this.cellSize,this.ctx.fillStyle="black",this.ctx.fillRect(0,0,3e3,3e3);for(var t=0;t<this.height;t++){this.grid[t]=[[]],this.temp[t]=[[]];for(var e=0;e<this.width;e++)this.grid[t][e]=[Math.round(Math.random()),0],this.temp[t][e]=[0,0],0!=e&&0!=t&&e!=this.width-1&&t!=this.height-1||(this.grid[t][e]=0)}},getMousePos:function(t,e){var i=this.canvas.getBoundingClientRect();return{x:Math.floor((e.clientX-i.left)/this.cellSize),y:Math.floor((e.clientY-i.top)/this.cellSize)}},clickEffect:function(t,e){if(this.audioClick){var i=parseFloat(document.getElementById("freq").value),s=parseFloat(document.getElementById("attack").value),a=parseFloat(document.getElementById("decay").value),r=parseFloat(document.getElementById("cm").value),l=parseFloat(document.getElementById("indexV").value);this.grid[e][t][3]=1,this.grid[e][t][4]=i,this.grid[e][t][5]=s,this.grid[e][t][6]=a,this.grid[e][t][7]=r,this.grid[e][t][8]=l}else switch(this.shape){case"flyer":this.grid[e-1][t][0]=1,this.grid[e][t+1][0]=1,this.grid[e+1][t-1][0]=1,this.grid[e+1][t][0]=1,this.grid[e+1][t+1][0]=1;break;case"blinker":this.grid[e][t][0]=1,this.grid[e-1][t][0]=1,this.grid[e+1][t][0]=1}console.log(t+","+e)},controls:function(){var t=this;document.querySelector("canvas").addEventListener("click",function(e){var i=t.getMousePos(this.canvas,e);i.x,i.y;t.clickEffect(i.x,i.y)},!1),document.querySelector("#play").onclick=function(e){t.play()},document.querySelector("#forward").onclick=function(e){t.forward()},document.querySelector("#speed").onchange=function(e){t.framesLimit=e.target.value,document.querySelector("#speedVal").value=e.target.value},document.querySelector("#bgOpacity").onchange=function(e){t.bgOpacity=e.target.value/100,document.querySelector("#opacityVal").value=e.target.value},document.querySelector("#dispMode").onchange=function(e){"aesthetics"==e.target.value?(t.accurate=!1,t.gridSetup()):(t.accurate=!0,t.gridSetup())},document.querySelector("#glitch").onchange=function(e){e.target.checked?t.glitch=!0:t.glitch=!1},document.querySelector("#colorMode").onchange=function(e){t.colorMode=e.target.value},document.querySelector("#hue").onchange=function(e){t.hueVal=e.target.value,document.querySelector("#hueVal").value=e.target.value},document.querySelector("#saturation").onchange=function(e){t.satVal=e.target.value,document.querySelector("#saturationVal").value=e.target.value},document.querySelector("#bright").onchange=function(e){t.brightVal=e.target.value,document.querySelector("#brightVal").value=e.target.value},document.querySelector("#cellSize").onchange=function(e){t.cellSize=e.target.value,t.gridSetup(),document.querySelector("#cellSizeVal").value=e.target.value},document.querySelector("#width").onchange=function(e){t.width=e.target.value,t.gridSetup(),document.querySelector("#widthVal").value=e.target.value},document.querySelector("#height").onchange=function(e){t.height=e.target.value,t.gridSetup(),document.querySelector("#heightVal").value=e.target.value},document.querySelector("#maxAge").onchange=function(e){t.maxAge=e.target.value,document.querySelector("#maxAgeVal").value=e.target.value},document.querySelector("#colorRate").onchange=function(e){t.colorRate=e.target.value,document.querySelector("#colorRateVal").value=e.target.value},document.querySelector("#border").onchange=function(e){0==e.target.value?t.border=!1:(t.border=!0,t.lineW=e.target.value),document.querySelector("#borderVal").value=e.target.value},document.querySelector("#clickMode").onchange=function(e){"audio"==e.target.value?(t.audioClick=!0,$("#structure").css("display","none"),$("#audio-box").css("display","block"),console.log("audio")):(t.audioClick=!1,$("#audio-box").css("display","none"),$("#structure").css("display","block"),console.log("struct"))},document.querySelector("#instrument").onchange=function(e){t.instrument=e.target.value},document.querySelector("#mute").onchange=function(e){"mute"==e.target.value?t.sound=!1:t.sound=!0},document.querySelector("#shape").onchange=function(e){t.shape=e.target.value}},runAutomata:function(){this.liveCount=0;for(var t=1;t<this.height-1;t++)for(var e=1;e<this.width-1;e++){if(1==this.grid[t-1][e-1][0]&&this.liveCount++,1==this.grid[t-1][e][0]&&this.liveCount++,1==this.grid[t-1][e+1][0]&&this.liveCount++,1==this.grid[t][e-1][0]&&this.liveCount++,1==this.grid[t][e+1][0]&&this.liveCount++,1==this.grid[t+1][e-1][0]&&this.liveCount++,1==this.grid[t+1][e][0]&&this.liveCount++,1==this.grid[t+1][e+1][0]&&this.liveCount++,1==this.grid[t][e][0]){if(1==this.liveCount||0==this.liveCount?(this.temp[t][e][0]=0,this.temp[t][e][1]=0):2==this.liveCount||3==this.liveCount?(this.temp[t][e][0]=1,this.temp[t][e][1]++):(this.temp[t][e][0]=0,this.temp[t][e][1]=0),this.grid[t][e][1]>=this.maxAge)if(this.temp[t][e][0]=0,this.temp[t][e][1]=0,1==this.grid[t][e][3]){var i=this.grid[t][e];this.playNote(i[4],i[5],i[6],i[7],i[8])}else if(this.sound)switch(this.instrument){case"piano":this.playNote(50*e,.044,1.411,3.5307,1);break;case"glockenspiel":this.playNote(50*e,.1,1,1.5,1.5);break;case"gong":this.playNote(5*e,1,1.411,1.7,1);break;case"marimba":this.playNote(20*e,.06,.5,4,2)}}else 0==this.grid[t][e][0]&&(3==this.liveCount?(this.temp[t][e][0]=1,this.temp[t][e][1]++):(this.temp[t][e][0]=0,this.temp[t][e][1]=0));this.liveCount=0,this.grid[t][e][10]=this.grid[t][e][1]*this.colorRate}var s=this.grid;this.grid=this.temp,this.accurate&&(this.temp=s)},draw:function(){this.ctx.fillStyle="rgba(0,0, 0,"+this.bgOpacity+")",this.ctx.fillRect(0,0,this.width*this.cellSize,this.height*this.cellSize),this.ctx.strokeStyle="black",this.ctx.lineWidth=this.lineW;for(var t=0;t<this.height;t++){for(var e=0;e<this.width;e++){switch(this.colorMode){case"pink":this.ctx.fillStyle="hsl( 280, "+3*this.grid[t][e][10]+"%, "+1.2*this.grid[t][e][10]+"%)";break;case"green":this.ctx.fillStyle="hsl(89 ,"+this.grid[t][e][10]+"%, "+.7*this.grid[t][e][10]+"%)";break;case"orange":this.ctx.fillStyle="hsl( 23, "+this.grid[t][e][10]+"%, "+.5*this.grid[t][e][10]+"%)";break;case"B&W":this.ctx.fillStyle="hsl( 0, 0%, "+this.grid[t][e][10]+"%)";break;case"custom":this.ctx.fillStyle="hsl("+this.hueVal+","+this.satVal/30*this.grid[t][e][10]+"%,"+this.brightVal/30*this.grid[t][e][10]+"%)";break;case"rainbow":this.ctx.fillStyle="hsl("+this.hueVal+","+this.satVal/30*this.grid[t][e][10]+"%,"+this.brightVal/30*this.grid[t][e][10]+"%)",this.hueVal++;break;case"pulseF":case"pulseS":this.ctx.fillStyle="hsl("+this.hueVal+","+this.satVal/30*this.grid[t][e][10]+"%,"+this.brightVal/30*this.grid[t][e][10]+"%)"}if(1==this.grid[t][e][0])if(this.grid[t][e][1]==this.maxAge-1?this.ctx.fillStyle="red":1==this.grid[t][e][3]&&(this.ctx.fillStyle="hsl( 124, 100%, 60%)"),this.glitch){if(1==this.getRandomInt(0,1)){var i=this.getRandomInt(0,3),s=this.getRandomInt(1,10);switch(i){case 0:this.ctx.fillRect(e*this.cellSize-s,t*this.cellSize,this.cellSize,this.cellSize);break;case 1:this.ctx.fillRect(e*this.cellSize+s,t*this.cellSize,this.cellSize,this.cellSize);break;case 2:this.ctx.fillRect(e*this.cellSize,t*this.cellSize+s,this.cellSize,this.cellSize);break;case 3:this.ctx.fillRect(e*this.cellSize-s,t*this.cellSize,this.cellSize,this.cellSize)}}}else this.ctx.fillRect((e-1)*this.cellSize,(t-1)*this.cellSize,this.cellSize,this.cellSize),this.border&&this.ctx.strokeRect((e-1)*this.cellSize,(t-1)*this.cellSize,this.cellSize,this.cellSize);else 0==e||0==t||e==this.width-1||this.height}"pulseF"==this.colorMode?this.hueVal++:"pulseS"==this.colorMode&&++this.slowCount>30&&(this.hueVal++,this.slowCount=0)}this.runAutomata()},play:function(){this.playBool?this.playBool=!1:this.playBool=!0,console.log("play")},forward:function(){this.draw()},playNote:function(t,e,i,s,a){var r=this.audCtx.createOscillator();r.type="sine",r.frequency.value=t;var l=this.audCtx.createOscillator();l.type="sine";this.audCtx.createConvolver();l.frequency.value=t*s;var o=this.audCtx.createGain();o.gain.value=t*a,l.connect(o),o.connect(r.frequency);var h=this.audCtx.createGain();h.gain.linearRampToValueAtTime(1,this.audCtx.currentTime+e),h.gain.linearRampToValueAtTime(0,this.audCtx.currentTime+e+i),r.connect(h),h.connect(this.audCtx.destination),l.start(this.audCtx.currentTime),r.start(this.audCtx.currentTime),l.stop(this.audCtx.currentTime+e+i),r.stop(this.audCtx.currentTime+e+i)},update:function(){this.playBool?(this.frames>=this.framesLimit&&(this.draw(),this.frames=0),this.frames++):this.playBool},getRandomInt:function(t,e){return Math.floor(Math.random()*(e-t+1)+t)}};e.exports=s},{}]},{},[2]);